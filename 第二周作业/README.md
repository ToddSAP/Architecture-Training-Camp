# 作业

## 1. 请描述什么是依赖倒置原则，为什么有时候依赖倒置原则又被称为好莱坞原则？
 - 高层模块不应该依赖于底层模块，两者都应该依赖抽象  
 - 抽象不应该依赖于细节  
 - 细节应该依赖于抽象 
 - 高层模块就是在调用关系上位于上层的模块，而底层模块就是位于底层的模块。  
 - 如果高层模块直接依赖底层模块会导致强耦合，不利于扩展和复用。  
 - 在实践上，可以用接口来作为抽象，模块间通过依赖接口来建立调用关系。实现接口的类可以在需要时动态注入，从而实现代码的解耦和复用。  

## 2. 请描述一个你熟悉的框架，是如何实现依赖倒置原则的。
 - JDK中序列化：
    - 所有需要支持序列化的类都需要实现Serializable接口，即依赖抽象Serializable接口，而JDK序列化框架也依赖于Serializable接口来判定是否可以执行序列化。  
 - Spring中类注册--配置文件方式：
    - 需要被Spring托管的类都需要按格式配置在applicationContext*.xml中，而Spring框架也是读取配置文件然后完成类注册。配置文件就是抽象，而上、下层模块都依赖抽象。  

## 3. 请用接口隔离原则优化Cache类的设计，画出优化后的类图。  
 - 将Cache接口分解为CacheService和CacheManagement两个接口，其中CacheService暴露给应用程序，而CacheManagement暴露给系统管理模块调用。  
 - 在应用程序类中使用CacheService，注入Cache类后，应用程序将仅能看到`get、put`和`delete`方法。  
 - 在系统管理类中使用CacheManagement，注入Cache类后，应用程序将仅能看到`reBuild`方法。    
 [代码](https://github.com/ToddSAP/Architecture-Training-Camp/tree/master/%E7%AC%AC%E4%BA%8C%E5%91%A8%E4%BD%9C%E4%B8%9A/cache)  
 ![类图](https://github.com/ToddSAP/Architecture-Training-Camp/blob/master/%E7%AC%AC%E4%BA%8C%E5%91%A8%E4%BD%9C%E4%B8%9A/%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E7%B1%BB%E5%9B%BE.png)
 
 
 
# 总结

## 一、 面向对象设计原则(SOLID) 

### 1. 单一职责原则
 - 一个类和模块只完成一个职责。  
 - 核心是定义清楚问题域，保持类和模块的粒度适中。  
 - 职责的定义要根据实际场景而定，即拆分的粒度要适合业务场景。  
 - 单一职责可以提高代码的复用性和内聚性。  
 - 判断职责单一的一些技巧：
    - 类的代码、方法或属性过多，往往意味着一个类里包含了过多的职责。  
    - 类和模块的起名困难，可能是职责不单一导致名字要覆盖多个职责。  
    - 功能偏斜，即某些功能使用率很高而某些功能基本不使用，那么不使用的那些功能可以考虑拆分到独立的类中。  
    - 类依赖过多其他类，可以是业务复杂，也可能是糅合了多个职责，可以考虑拆分。  


### 2. 开闭原则
 - 核心在于要做好面向抽象编程，并充分利用好多态特性。  
 - 做好了模块、类都依赖抽象之后，在需要增加新功能时，只需要扩展抽象的实现即可。在需要修改原有功能时，只需要增加粘合层代码即可。  
 - 另一个比较重要的点就是要有预判扩展的能力，能识别出哪些场景可能会在未来发生，从而针对性地剥离不变和善变的部分。  
 

### 3. 里氏替换原则
 - 里氏替换不是子类替代父类那么简单，原则是子类的行为不改变父类的行为，即业务逻辑要前后一致。  
 - 里氏替换是对多态使用的一种最佳实践，规定了多态时的行为准则。遵守的好处是不用担心业务逻辑在不经意间被改变，从而导致bug。  
 - 常见的违反里氏替换原则的做法：
    - 子类改变了父类声明要实现的功能。如父类方法orderByAmountDesc，结果子类的方法是升序。  
    - 子类改变了父类的输入、输出、异常的声明。如父类的返回缺省值是null，但子类将缺省值改成了throw Exception。  
 - 单元测试非常重要，对于设计良好的方法， UT可以很大程度上检测并保证父类的逻辑不被子类破坏。  
 
 
### 4. 接口隔离原则
 - 其实是封装性和单一职责原则的扩展体现。接口的设计应该粒度适中，同一问题域的功能才应该放在同一接口中。  
 - 好处是利用接口就可以界定清楚问题域，在实现上，面向需要的接口编码即可避免强耦合。  
 - 接口可以理解为一组接口组合、单个API接口或函数、OOP概念里的接口。   
 
### 5. 依赖倒置原则
 - 该原则是从调用者和被调用者的角度来阐述程序设计中的优劣。  
    - 调用者直接持有被调用者的实现，好处是使用方便，坏处是强耦合、无法复用、对后续修改/扩展不友好。  
    - 调用者依赖被调用者的抽象，好处是实现了解耦、提高了内聚性、复用性、可扩展性，坏处是持有了依赖的代码，还存在耦合。  
    - 反转调用者和被调用者间的关系，对于框架类代码是很有好处的，只需要提供扩展点，由调用者实现即可。  
 - 依赖注入也是依赖倒置原则的体现，即调用者不用关系依赖如何获取，而是由框架负责在runtime注入进来。  
 

## 二、框架和工具

### 1. 框架
 - 框架划定了核心的业务流程，即不变的部分。  
 - 开发者只需要实现框架的扩展点，就可以将具体的业务逻辑整合到业务流程中。  
 - 框架代码无需耦合到业务代码中。  
 - 典型的框架：
    - Spring  
    - MyBatis  
    - Hibernate  
    - Tomcat  
   
### 2. 工具  
 - 实现某种特定功能的代码集合，供业务代码调用。  
 - 工具代码需要耦合到业务代码中，这可能会导致一些复用性上的问题。可以视具体场景，将调用工具代码的部分隔离到独立类中，以便降低与业务代码的耦合。  
 


